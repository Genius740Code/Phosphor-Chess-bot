# mingw32-make -f MakeFile 

# Compiler and flags
CXX = g++
CXXFLAGS = -Wall -Wextra -O2 -std=c++17 -Isrc/include
LDFLAGS = -Lsrc/lib -lsfml-graphics -lsfml-window -lsfml-system -lopengl32 -lsfml-audio

# Source files and objects
SRCDIR = code
SRCS = $(wildcard $(SRCDIR)/*.cpp)
OBJS = $(patsubst $(SRCDIR)/%.cpp,%.o,$(SRCS))
EXECUTABLE = main

.PHONY: all clean debug release run

all: $(EXECUTABLE)

# Debug build with debugging symbols
debug: CXXFLAGS += -g -DDEBUG
debug: clean all

# Release build with full optimization
release: CXXFLAGS += -O3 -march=native -DNDEBUG
release: clean all

%.o: $(SRCDIR)/%.cpp
	$(CXX) $(CXXFLAGS) -c $< -o $@

$(EXECUTABLE): $(OBJS)
	$(CXX) $^ -o $@ $(LDFLAGS)
	@echo "Build complete: $@"

clean:
	rm -f *.o $(EXECUTABLE).exe $(EXECUTABLE)

run: all
	./$(EXECUTABLE)

# Git checkpoint target
git-checkpoint:
	@echo "Saving workspace..."
	git init -q || true
	git add .
	git commit -m "Workspace saved"
	@echo "Workspace saved successfully!"


# # Make sure you're on the free-movmentv2 branch
#git checkout free-movmentv2

# Reset to the first commit of this branch
#git reset --hard $(git rev-list --max-parents=0 HEAD)